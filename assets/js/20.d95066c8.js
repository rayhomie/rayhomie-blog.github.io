(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{365:function(t,s,a){"use strict";a.r(s);var n=a(42),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"从本质上理解this指向问题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#从本质上理解this指向问题"}},[t._v("#")]),t._v(" 从本质上理解this指向问题")]),t._v(" "),a("p",[t._v("我们先来真正了解一下"),a("code",[t._v("js")]),t._v("里面的函数，")]),t._v(" "),a("ul",[a("li",[t._v("特点：\n"),a("ul",[a("li",[t._v("有名字（匿名也行）")]),t._v(" "),a("li",[a("strong",[t._v("支持闭包")])]),t._v(" "),a("li",[a("strong",[t._v("创建函数作用域")])]),t._v(" "),a("li",[t._v("*有"),a("code",[t._v("arguments")])]),t._v(" "),a("li",[t._v("*有"),a("code",[t._v("this")])]),t._v(" "),a("li",[t._v("*支持"),a("code",[t._v("new语法糖")])]),t._v(" "),a("li",[a("strong",[t._v("是一个对象，有"),a("code",[t._v("name/lenght/call/apply/bind")]),t._v("属性")])]),t._v(" "),a("li",[a("code",[t._v("0~n")]),t._v("个参数、"),a("code",[t._v("1")]),t._v("个返回值")]),t._v(" "),a("li",[t._v("参数相同，返回值可能不同\n"),a("ul",[a("li",[t._v("注意：标有*的都是ES6中箭头函数不支持的。")])])])])])]),t._v(" "),a("p",[t._v("我们再来复习一下"),a("code",[t._v("js")]),t._v("中声明一个函数的四种方式：")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//使用创建函数对象的方式")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" f1 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'x'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'y'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'return x+y'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//最普通的创建函数的方式")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("f2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("x"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("y")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" x"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("y"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//创建匿名函数方式")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("f3")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("x"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("y")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" x"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("y"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//ES6创建匿名函数的方式")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("f4")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("x"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("y")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v("x"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("y\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//其中前三种方式是ES6之前的语法，支持this/arguments/new")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//而第四种是ES6新语法，不支持this/arguments/new")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//这里没有介绍generator函数和async函数")]),t._v("\n")])])]),a("p",[t._v("这里说的箭头函数不支持"),a("code",[t._v("this")]),t._v("？？箭头函数里面写"),a("code",[t._v("this")]),t._v("不是不报错吗？为什么说它不知"),a("code",[t._v("this")]),t._v("呢？？")]),t._v(" "),a("p",[t._v("我们来继续看下面两段代码：")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//代码1")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" a "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("233")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("f2")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v("console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("a"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//代码2")]),t._v("\nconsole"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("f1")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v("console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n")])])]),a("p",[t._v("箭头函数如何处理"),a("code",[t._v("a")]),t._v("，就如何处理"),a("code",[t._v("this")]),t._v("，即"),a("strong",[t._v("箭头函数把"),a("code",[t._v("this")]),t._v("当做外部变量")]),t._v("，仅此而已，但是"),a("strong",[t._v("非ES6箭头函数的this就做了很多特殊处理")]),t._v("。")]),t._v(" "),a("p",[t._v("我们这里说的箭头函数不支持"),a("code",[t._v("this")]),t._v("指的就是箭头函数对"),a("code",[t._v("this")]),t._v("和其他变量一视同仁，不会特殊处理。")]),t._v(" "),a("p",[t._v("说到这我们进入今天的正题，轻轻松松搞定"),a("code",[t._v("this")]),t._v("指向！！！")]),t._v(" "),a("h2",{attrs:{id:"非箭头函数的this"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#非箭头函数的this"}},[t._v("#")]),t._v(" 非箭头函数的"),a("code",[t._v("this")])]),t._v(" "),a("h4",{attrs:{id:"网上也有很多js函数this指向的相关理解，比如："}},[a("a",{staticClass:"header-anchor",attrs:{href:"#网上也有很多js函数this指向的相关理解，比如："}},[t._v("#")]),t._v(" 网上也有很多js函数this指向的相关理解，比如：")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("this")]),t._v("是执行上下文；")]),t._v(" "),a("li",[t._v("全局环境执行函数时，"),a("code",[t._v("this")]),t._v("是全局对象；")]),t._v(" "),a("li",[t._v("调用对象的方法时，"),a("code",[t._v("this")]),t._v("是该对象；")]),t._v(" "),a("li",[t._v("函数里调用函数时，"),a("code",[t._v("this")]),t._v("是全局对象；")]),t._v(" "),a("li",[t._v("箭头函数里的"),a("code",[t._v("this")]),t._v("，不看调用，看定义（静态作用域）;")]),t._v(" "),a("li",[t._v("还有人说箭头函数里的"),a("code",[t._v("this")]),t._v("指向外面的"),a("code",[t._v("this")]),t._v(";")]),t._v(" "),a("li",[t._v("用"),a("code",[t._v("new")]),t._v("调用函数时，"),a("code",[t._v("this")]),t._v("是新增对象；")]),t._v(" "),a("li",[t._v("可以用"),a("code",[t._v("call/apply/bind")]),t._v("指定"),a("code",[t._v("this")]),t._v("；")])]),t._v(" "),a("h4",{attrs:{id:"我来说说我在方应杭老师教的方法："}},[a("a",{staticClass:"header-anchor",attrs:{href:"#我来说说我在方应杭老师教的方法："}},[t._v("#")]),t._v(" 我来说说我在方应杭老师教的方法：")]),t._v(" "),a("p",[t._v("我们先来回顾一下js中函数返回值的影响因素：")]),t._v(" "),a("ul",[a("li",[t._v("调用时输入的参数"),a("code",[t._v("params")]),t._v("（执行上下文）")]),t._v(" "),a("li",[t._v("定义时的环境"),a("code",[t._v("evn")]),t._v("（词法环境）")])]),t._v(" "),a("p",[t._v("那么"),a("code",[t._v("this")]),t._v("是参数还是环境呢？")]),t._v(" "),a("p",[t._v("有人说"),a("code",[t._v("this")]),t._v("是上下文，不是他们说的的不对，但是对于新手萌新来说就是理解不清楚，这种用概念去解释概念的说法，就是脱了裤子放屁。")]),t._v(" "),a("p",[t._v("我认为"),a("code",[t._v("this")]),t._v("是参数，就是一个"),a("strong",[t._v("函数隐式的参数")]),t._v("而已。")]),t._v(" "),a("h4",{attrs:{id:"this的确定："}},[a("a",{staticClass:"header-anchor",attrs:{href:"#this的确定："}},[t._v("#")]),t._v(" this的确定：")]),t._v(" "),a("p",[a("strong",[t._v("其实所有的函数在调用执行的时候都是使用了"),a("code",[t._v(".call")]),t._v("或者"),a("code",[t._v(".bind")]),t._v("方法进行"),a("code",[t._v("this")]),t._v("的绑定，只是分为了显式绑定和隐式绑定（默认绑定this）而已。")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//显式绑定")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("fn")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("call")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("asThis"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("fn")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("bind")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("asThis"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nobj"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("method")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("call")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("obj"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'hi'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//默认绑定this(隐式绑定)")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//我们现在代码都是省略的写法，本来很久以前创建函数都是需要绑定this的，但是js设计者为了让代码看起来跟简约，就约定了简便的写法，然后后来大家就不了解其本质。")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//1.对于普通函数")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("fn")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//等同于fn.call(undefined,1,2)")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//2.对于对象中的方法")]),t._v("\nobj"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("method")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'hi'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//等同于obj.method.call(obj,'hi')")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//3.对于数组")]),t._v("\narray"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'hi'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//等同于array[0].call(array,'hi')")]),t._v("\n\n")])])]),a("p",[a("em",[a("strong",[t._v("所以我们确定"),a("code",[t._v("this")]),t._v("指向就直接可以把隐式绑定修改成显式绑定就可以看出来了。")])])]),t._v(" "),a("p",[t._v("也就是说我们只需要记住上面三种对"),a("strong",[t._v("普通函数")]),t._v("、对"),a("strong",[t._v("js对象中的方法")]),t._v("、对"),a("strong",[t._v("数组的隐式绑定")]),t._v("，就可以了")]),t._v(" "),a("p",[t._v("来实战一道题：")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" vm "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Vue")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  \tdata"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    \tmessage"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'hi'")]),t._v(" \n  \t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  \tmetheds"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n \t\t   \t"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sayHi")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    \t  \tconsole"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("message"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// this")]),t._v("\n    \t\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//vm.sayHi.call(vm)")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//改写成隐式绑定this")]),t._v("\n")])])]),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("button"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("onclick")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("e")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//答：button是错的。没有说是在这个代码在哪里写来执行的。")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//改写成隐式绑定this：button.click.call(button,e)")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//如果在浏览器中执行代码。用户触发点击事件的时候，会被改成，")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//button.click.call(window,e)此时this又变成了window")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//所以说不同的地方调用.call中指向是不一样的。")]),t._v("\n")])])]),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" length "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("fn")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" obj "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  length"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("method")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("fn")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("fn")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\nobj"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("method")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("fn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//输出什么")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//obj.method.call(obj,fn)此时this指向obj")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//window.fn.call(window)此时this指向window")]),t._v("\n")])])]),a("p",[t._v("此时你是不是觉得会打印出："),a("code",[t._v("“10”")]),t._v("，答案是错的，是不是很懵逼哈哈哈哈。")]),t._v(" "),a("p",[t._v("一看到"),a("code",[t._v("let")]),t._v("就要警觉一下了，"),a("a",{attrs:{href:"https://blog.csdn.net/fang_ze_zhang/article/details/83419022",target:"_blank",rel:"noopener noreferrer"}},[a("strong",[t._v("ES6中"),a("code",[t._v("const、let、class")]),t._v("声明的全局变量不属于顶层window对象属性，但是var、function声明的全局变量依然属于顶层对象window的属性")]),a("OutboundLink")],1),t._v("。也就是说从ES6开始全局变量和顶层对象的属性就开始脱离、脱钩。")]),t._v(" "),a("p",[t._v("在我的浏览器上面打印出来的答案是"),a("code",[t._v("“1”")]),t._v("，是不是很神奇，因为这个"),a("code",[t._v("window.length")]),t._v("是window对象的内置属性，指的是"),a("code",[t._v("frames")]),t._v("的数量。")]),t._v(" "),a("p",[t._v("我们再来看一道面试题：")]),t._v(" "),a("div",{staticClass:"language-html extra-class"},[a("pre",{pre:!0,attrs:{class:"language-html"}},[a("code",[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token script"}},[a("span",{pre:!0,attrs:{class:"token language-javascript"}},[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//在浏览器上运行此代码")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" xuuu "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("123")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("t")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" xuuu "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("456")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("aa "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("666")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("xuuu"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("aa"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("xuuu"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("t")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//结果：456 666 123")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 上面的代码等同于：")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//var c = window.t.call(window)")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// window.c.call(window)")]),t._v("\n        \n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" obj "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("t")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("obj")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//结果：456 undefined 123")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//此时上面代码等同于：")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//var obj = new t()")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//window.obj.call(window)")]),t._v("\n  \n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//为什么这时候this.aaa是undefined，因为new构造函数创建对象的时候，会执行这四步：")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//1、创建一个新对象")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//2、将构造函数的作用域赋给新对象（将this指向这个新对象）")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//3、执行构造函数代码（为这个新对象添加属性）")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//4、返回新对象")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//所以在第二步的时候修改this执行到了obj对象上面，aaa是obj对象里面的属性，但是再次执行obj()的时候this是指向的window，所以说不能访问到obj里面的aaa，此时window.aaa是undefined")]),t._v("\n")])]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),a("h4",{attrs:{id:"所以我们就记住以下规则："}},[a("a",{staticClass:"header-anchor",attrs:{href:"#所以我们就记住以下规则："}},[t._v("#")]),t._v(" 所以我们就记住以下规则：")]),t._v(" "),a("ul",[a("li",[a("strong",[a("code",[t._v("this")]),t._v("是"),a("code",[t._v("call")]),t._v("的第一个参数")])]),t._v(" "),a("li",[a("strong",[a("code",[t._v("new")]),t._v("重新设计了"),a("code",[t._v("this")])])]),t._v(" "),a("li",[a("strong",[t._v("箭头函数不接受"),a("code",[t._v("this")])])])])])}),[],!1,null,null,null);s.default=e.exports}}]);